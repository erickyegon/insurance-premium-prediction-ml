[2026-01-08 12:30:28,146] 604  root - INFO - Running as script.
[2026-01-08 12:30:28,147] 656  root - INFO - Starting data transformation pipeline.
[2026-01-08 12:30:28,173] 661  root - INFO - Loaded train shape: (8000, 15)
[2026-01-08 12:30:28,174] 662  root - INFO - Loaded test shape:  (2000, 15)
[2026-01-08 12:30:28,174] 480  root - INFO - [train] Standardizing column names.
[2026-01-08 12:30:28,176] 480  root - INFO - [test] Standardizing column names.
[2026-01-08 12:30:28,177] 673  root - INFO - Cleaning enabled.
[2026-01-08 12:30:28,178] 202  root - INFO - Missing-value strategy=keep: leaving NA for pipeline imputers.
[2026-01-08 12:30:28,178] 202  root - INFO - Missing-value strategy=keep: leaving NA for pipeline imputers.
[2026-01-08 12:30:28,186] 214  root - INFO - Dropped 0 duplicate rows.
[2026-01-08 12:30:28,189] 214  root - INFO - Dropped 0 duplicate rows.
[2026-01-08 12:30:28,189] 681  root - INFO - Feature engineering enabled.
[2026-01-08 12:30:28,191] 413  root - INFO - Target leakage disallowed; no target-derived features.
[2026-01-08 12:30:28,196] 444  root - INFO - Engineered 0 new features.
[2026-01-08 12:30:28,196] 413  root - INFO - Target leakage disallowed; no target-derived features.
[2026-01-08 12:30:28,199] 444  root - INFO - Engineered 0 new features.
[2026-01-08 12:30:28,204] 724  root - INFO - EDA enabled; saving artifacts.
[2026-01-08 12:30:28,204] 313  root - INFO - EDA started for train.
[2026-01-08 12:30:28,237] 318  root - INFO - Saved stats summary: artifacts\eda\train_stats_summary.csv
[2026-01-08 12:30:28,248] 329  root - INFO - Saved missingness report: artifacts\eda\train_missingness.csv
[2026-01-08 12:30:29,121] 353  root - INFO - Saved boxplot: artifacts\eda\train_outliers_boxplot.png
[2026-01-08 12:30:29,132] 359  root - INFO - Saved correlation CSV: artifacts\eda\train_correlation.csv
[2026-01-08 12:30:29,745] 378  root - INFO - Saved correlation heatmap: artifacts\eda\train_correlation_heatmap.png
[2026-01-08 12:30:29,745] 380  root - INFO - EDA completed for train.
[2026-01-08 12:30:29,746] 313  root - INFO - EDA started for test.
[2026-01-08 12:30:29,769] 318  root - INFO - Saved stats summary: artifacts\eda\test_stats_summary.csv
[2026-01-08 12:30:29,778] 329  root - INFO - Saved missingness report: artifacts\eda\test_missingness.csv
[2026-01-08 12:30:30,335] 353  root - INFO - Saved boxplot: artifacts\eda\test_outliers_boxplot.png
[2026-01-08 12:30:30,342] 359  root - INFO - Saved correlation CSV: artifacts\eda\test_correlation.csv
[2026-01-08 12:30:30,978] 378  root - INFO - Saved correlation heatmap: artifacts\eda\test_correlation_heatmap.png
[2026-01-08 12:30:30,978] 380  root - INFO - EDA completed for test.
[2026-01-08 12:30:30,989] 604  root - INFO - Saved VIF report: artifacts\vif_report.csv
[2026-01-08 12:30:30,998] 747  root - INFO - Numeric features (3): ['age', 'number_of_dependants', 'income_lakhs']
[2026-01-08 12:30:30,998] 748  root - INFO - Categorical features (10): ['gender', 'region', 'marital_status', 'physical_activity', 'stress_level', 'bmi_category', 'smoking_status', 'employment_status', 'medical_history', 'insurance_plan']
[2026-01-08 12:30:30,998] 749  root - INFO - Target: annual_premium_amount
[2026-01-08 12:30:30,998] 753  root - INFO - Fitting preprocessor on train.
[2026-01-08 12:30:31,049] 774  root - INFO - Saved preprocessor: artifacts\preprocessor.pkl
[2026-01-08 12:30:31,049] 775  root - INFO - Saved train: artifacts\train_transformed.npy
[2026-01-08 12:30:31,049] 776  root - INFO - Saved test: artifacts\test_transformed.npy
[2026-01-08 12:30:31,049] 777  root - INFO - Shapes: Train (8000, 40) | Test (2000, 40)
[2026-01-08 12:30:31,050] 614  root - INFO - Preprocessor: artifacts\preprocessor.pkl
[2026-01-08 12:30:31,050] 493  root - INFO - Starting training.
[2026-01-08 12:30:31,051] 500  root - INFO - Train: X=(8000, 39) y=(8000,)
[2026-01-08 12:30:31,051] 501  root - INFO - Test: X=(2000, 39) y=(2000,)
[2026-01-08 12:30:31,053] 506  root - INFO - Internal: Train=(6400, 39) Val=(1600, 39)
[2026-01-08 12:30:31,055] 516  root - INFO - Baseline: LinearRegression
[2026-01-08 12:30:31,077] 524  root - INFO - Baseline: Ridge
[2026-01-08 12:30:31,087] 533  root - INFO - Baseline: Lasso
[2026-01-08 12:30:31,394] 314  root - INFO - RandomizedSearchCV for XGBoost (n_iter=20, cv=3).
[2026-01-08 12:30:53,935] 319  root - INFO - Best params: {'subsample': 1.0, 'reg_lambda': 1.0, 'reg_alpha': 0.01, 'n_estimators': 300, 'min_child_weight': 5, 'max_depth': 3, 'learning_rate': 0.2, 'colsample_bytree': 0.7}
[2026-01-08 12:30:53,935] 320  root - INFO - Best CV score: 0.993110
[2026-01-08 12:30:53,936] 323  root - INFO - Early-stopping refinement.
[2026-01-08 12:30:53,936] 341  root - WARNING - Early stopping skipped; using CV-best.
[2026-01-08 12:30:53,946] 557  root - INFO - Saved leaderboard: artifacts\model_leaderboard.csv
[2026-01-08 12:30:53,952] 561  root - INFO - Saved model: artifacts\model.pkl
[2026-01-08 12:30:53,974] 164  root - INFO - Saved results_df: artifacts\results_predictions.csv
[2026-01-08 12:30:53,975] 593  root - ERROR - Training failed.
Traceback (most recent call last):
  File "C:\2026 Projects\Shield Insurance\src\components\model_trainer.py", line 565, in initiate_model_trainer
    self._save_residual_diagnostics(y_test, best_preds)
  File "C:\2026 Projects\Shield Insurance\src\components\model_trainer.py", line 205, in _save_residual_diagnostics
    if sns:
UnboundLocalError: local variable 'sns' referenced before assignment
